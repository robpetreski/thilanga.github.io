---
layout: post
title: Magento - How to switch Base URLs without modifying the Database
date: 2013-01-19
comments: false
---


<div class='post'>
    <div dir="ltr" style="text-align: left;" trbidi="on">
        <div dir="ltr" style="text-align: left;" trbidi="on">As Magento keeps its base URL in&nbsp;database, there is no
            easy way of&nbsp;accessing&nbsp;the same database from two different URLs(dev/ staging) or moving the same
            database to staging&nbsp;environment&nbsp;from development without updating&nbsp;core_config_data
            table.<br/><br/>After fiddling around with Magento core, I found that getBaseUrl() is responsible of
            retrieving base URL. So If we could override getBaseUrl() method to get the base URL from dev or staging&nbsp;environments&nbsp;without
            depending on the database, then we could keep database records with live settings.<br/><br/>Below code will
            explain how I&nbsp;achieved&nbsp;this task and the code itself is explainable.<br/><br/>1.
            app/etc/modules/My_Configurator.xml<br/>
            <pre class="brush:xml"><config><br/>
                <modules><br/>
                    <my_configurator><br/>
                        <active>true</active>
                        <br/>
                        <codepool>local</codepool>
                        <br/></my_configurator>
                    <br/></modules>
                <br/></config><br/></pre>
            <br/>2. app/code/local/My/Configurator/etc/config.xml<br/>
            <pre class="brush:xml"><config><br/>
                <global><br/>
                    <models><br/>
                        <core><br/>
                            <rewrite><br/>
                                <store>My_Configurator_Model_Store</store>
                                <br/></rewrite>
                            <br/></core>
                        <br/></models>
                    <br/></global>
                <br/></config><br/></pre>
            <br/>3. app/code/local/My/Configurator/Model/Store.php<br/>
            <pre class="brush:php"><br/><?php<br />
                <br/>class My_Configurator_Model_Store extends Mage_Core_Model_Store<br/>{<br/>    public function getBaseUrl($type=self::URL_TYPE_LINK, $secure=null)<br/>    {<br/>        $url = parent::getBaseUrl($type, $secure);//domain from the DB<br/><br/>        $host = parse_url($url, PHP_URL_HOST);<br/>        return str_replace('://'.$host.'/', '://'.$_SERVER['HTTP_HOST'].'/', $url);<br/>    }<br/>}<br/>?><br/></pre>
        </div>
        <br/>Note: Make sure you disable this&nbsp;extension&nbsp;from production server as we want to run getBaseUrl()
        method from the Core.<br/><br/>Happy Coding..
    </div>
</div>
<h2>Comments</h2>
<div class='comments'>
    <div class='comment'>
        <div class='author'>Thilanga Pitigala</div>
        <div class='content'>
            @jennychalek Did you enable the extension? Can you see it under Admin-&gt;System-&gt;Configuration-&gt;Advanced?
        </div>
    </div>
    <div class='comment'>
        <div class='author'>jennychalek</div>
        <div class='content'>
            This is making me pull my hair out. I used this exact code and even though my IDE recognizes that the class
            has been successfully overriden, magento itself does not seem to know or care - it never calls the override
            class, just the original. Is there some sort of config setting I&#39;m missing? Any other ideas what could
            cause this? Grasping at straws at this point.
        </div>
    </div>
</div>
